<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <meta name="baidu-site-verification" content="R7Z8SGo67s" />

    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          卡巴斯基：APT组织2019行为大盘点（上） - 张嘉伟 | Blog
        
    </title>

    <link rel="canonical" href="https://tracy.pro/article/卡巴斯基：APT组织2019行为大盘点（上）/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">
    <link rel="stylesheet" href="/css/donate.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
    <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/691ddb0c.js","daovoice")
      daovoice('init', {
        app_id: "691ddb0c"
    });
    daovoice('update');
</script>
    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
    <!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('./home.png')
            /*post*/
        
    }
    
    #signature{
        background-image: url('/img/signature/BeanTechSign-white.png');
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#网络安全" title="网络安全">网络安全</a>
                            
                              <a class="tag" href="/tags/#APT" title="APT">APT</a>
                            
                        </div>
                        <h1>卡巴斯基：APT组织2019行为大盘点（上）</h1>
                        <h2 class="subheading">APT行为盘点</h2>
                        <span class="meta">
                            Posted by 张嘉伟 on
                            2019-12-10
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <span id="busuanzi_container_page_pv">
                                本文总阅读量<span id="busuanzi_value_page_pv"></span>次
                            </span>
                        </span>
                        
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">张嘉伟</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/photos/">Photos</a>
                        </li>
                        
                    

                        
                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/videos/">Videos</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <blockquote>
<p>在即将过去的2019年，APT组织又做了哪些恶？它们的发展动向是什么？我们又能从其中挖掘出怎样的规律？这些问题想要直白回答并不容易，因为研究人员不可能完全了解所有攻击事件及它们背后的发展动机，但我们可以试着从不同的角度来处理这个问题，以便更好地理解所发生的事情，并从中获得后见之明。</p>
</blockquote>
<h3 id="供应链攻击">供应链攻击</h3>
<p>近年来，供应链攻击是最危险和有效的感染途径之一，越来越多地被用于高级攻击行动中——其中最知名的要当属ShadowPad后门、勒索软件ExPetr和被后门化的工具CCleaner。这种攻击针对了产品生命周期中，从初始开发阶段到最终用户的各个环节，涉及人力、组织、物资和智力资源的种种。哪怕供应商的基础设施是安全的，但其提供商的设施中可能包含漏洞，从而危害到供应链，导致毁灭性和意外的数据泄露事故。</p>
<p>今年1月，我们就发现过一起名为ShadowHammer 行动的供应链攻击事件。攻击者以华硕的实时更新应用程序为感染初始源进行攻击。这种实时更新应用程序是一种预装应用，用于自动进行BIOS、UEFI驱动和应用程序更新。攻击者使用窃取到的华硕数字证书对旧版本的华硕软件进行更改，注入自己的恶意代码，包含木马的华硕应用程序使用了合法的数字签名，并且被放到官方的华硕更新服务器上进行传播和下载，使得大多数安全解决方案无法将其识别。据估计，有 50 万用户通过华硕的自动更新收到了恶意后门，但攻击者只对其中 600 台计算机发动了针对性的后续攻击。</p>
<h3 id="apt组织信息反泄露">APT组织信息反泄露</h3>
<p>今年3月，有人在Twitter上泄露了隶属于伊朗国家背景的APT攻击组织APT34（又名oilrig、HelixKitten）的黑客工具及相关人员信息。安全专家证实泄露信息确实跟APT 34组织有关。公布的信息还包括66个APT34组织受害者，主要是中东地区的政府机构和金融、能源等企业，与之前所掌握关于APT 34组织的情况相符。</p>
<p>4月22日，另一针对中东国家地区的APT组织MuddyWater信息又遭曝光，一个名为Bl4ck_B0X的用户在Telegram频道上公布了MuddyWater组织成员信息，甚至具体到成员的父母和配偶，4月27日还曝光了 其C2服务器的相关信息，但到了5月1日，该频道对公众关闭，状态改为私人，关闭的原因尚不清楚。</p>
<p>之后Hidden Reality网站上又曝光了伊朗RANA研究所数据，这次攻击者选择了任何人都能浏览的网站，披露了RANA机构计算机网络运营相关的内部文档、聊天记录，以及受害者信息等。此前揭秘的信息更多会集中在工具、源代码和配置文件上。</p>
<p>第三季度，中东地区的APT事态发展值得关注，尤其是伊朗短时间内又发生了多起数据泄密事件。</p>
<p>在对泄漏者所使用的材料，基础设施和专用网站的仔细分析后，我们推测上述这些事件可能都与Sofacy / Hades组织有关。</p>
<h3 id="新组织现身">新组织现身</h3>
<p>2017年，神秘黑客团体Shadow Brokers泄露了一个名为“ Lost in Translation ”的数据库，据称是从美国国家安全局（NSA）处入侵获得，包含一系列漏洞利用和黑客工具，比如大名鼎鼎的永恒之蓝漏洞和WannaCry勒索病毒。</p>
<p>但重点是，泄露的文件中还有一个名为sigs.py的Python脚本文件，该文件被NSA用作内置的恶意软件扫描程序，可以检查系统是否已被另一个APT组织破坏，即他国网军的攻击痕迹，从而通过是否存在攻击痕迹而执行下一步操作。文件执行的每次检查都是作为在系统中查找唯一签名的函数实现的，例如唯一名称或注册表路径的文件。sigs.py中列出了44个条目，也就是NSA能识别的44个APT组织，其中许多APT组织都尚未曝光于公众面前。</p>
<p>而今年，我们确定了sigs.py文件中标注的第27个APT组织——DarkUniverse。根据代码相关性，我们认为 DarkUniverse 就是操纵ItaDuke 恶意行动的幕后黑手，此次行动针对西亚和非洲东北部的医疗机构、核能机构、军事组织和电信公司进行，共有20多个单位受到影响。他们使用的主要组件是一个相当简单的 DLL，仅具有一个导出的功能，却能实现了持久性、恶意软件完整性、C2 通信以及对其他模块的控制。</p>
<h3 id="移动攻击">移动攻击</h3>
<p>移动攻击现在几乎成了每个APT组织的标配了，2019年有许多这样的案例发生。</p>
<p>今年5月，英国《金融时报》报道称，黑客利用了WhatsApp的一个0 day漏洞，能读取用户的加密聊天记录、开启麦克风和摄像头、安装间谍软件等，而利用漏洞的过程只需要攻击者通过WhatsApp给用户打电话即可，通过呼叫触发WhatsApp的缓冲区溢出，进而让攻击者控制应用程序并在其中执行任意代码。WhatsApp很快就发布了一个漏洞补丁。10月，WhatsApp对以色列NSO集团提起诉讼，指控后者对这一漏洞的开发利用行为，并声称NSO将此技术用于20个不同国家的1400多名客户身上，其中包括人权活动人士、记者及其他相关人士，但诉讼遭到了NSO的否决。</p>
<p>7月，我们介绍了在野发现的最新版FinSpy间谍软件。FinSpy是由德国Gamma Group公司制造的间谍软件，通过其在英国的子公司Gamma Group International向全球的政府和执法机构出售，被用于在各类平台上收集用户的私人信息。FinSpy有iOS和Android两个版本，出现在近20个国家。</p>
<p>8月，谷歌的Project Zero团队发表报告分析了至少14个在野发现的iOS 0 day漏洞，这些漏洞被用在5个开发链中，影响从 iOS 10 到 iOS 12 的几乎每一个版本。14个漏洞中有 7 个面向 iPhone 的 Web 浏览器、五个面向内核、两个瞄向单独的沙箱转义。据谷歌报道，攻击者可能从三年前就开始对一些网站发起水坑攻击，但谷歌没有列举被入侵网站的详细信息，只声称这些网站“每周都有成千上万的访问者”，是一种没有针对性的攻击。</p>
<p>9月，“网络军火商”Zerodium公司表示，Android的0 day现在要比iOS的价值高，公司愿意为零点击的Android 0 day支付250万美元的费用，相比该公司之前为远程iOS越狱支付的200万美元的上限有了大幅提高。同一月份，Android媒体驱动程序v412 (Video4Linux) driver被曝出高危0 day漏洞，同时又曝出另一Android漏洞，攻击者可以使用SMS消息完全访问受感染设备上的电子邮件，这一漏洞使超过10亿的三星、华为、LG、索尼等智能手机受到影响。</p>
<h3 id="apt组织的发展动向">APT组织的发展动向</h3>
<h4 id="turla">Turla</h4>
<p>今年在调查中亚的一些恶意活动时，我们确定了一个名为Tunnus的新后门，并将其归于Turla APT组织。Tunnus是基于.NET的恶意软件，能够在受感染的系统上运行命令或执行文件操作并将结果发送到C2。</p>
<p>Turla还创建了一个名为Topinambour的新dropper，用于分发其臭名昭著的恶意软件JavaScript KopiLuwak。恶意软件几乎完全是“无文件的”：只有在感染的最后阶段，将一个用于远程管理的加密木马嵌入计算机的注册表中。Turla组织还用两个跟KopiLuwak类似的恶意软件进行网络间谍活动——.NET RocketMan木马和PowerShell MiamiBeach木马。</p>
<p>Turla的另一款新工具Reductor是COMPfun木马的继承者，攻击者入侵Chrome和Firefox浏览器后可以利用TLS追踪用户。Reductor一个引人注目的方面是，攻击者花了很多精力来操纵已安装的数字根证书，并使用惟一的与主机相关的标识符标记出站TLS流量。该恶意软件将嵌入式根证书添加到目标主机，允许操作员通过命名管道远程添加其他证书。攻击者不需要接触网络数据包，相反，他们分析了Firefox源代码和Chrome二进制代码，修改了其中的PRNG代码，并针对每个用户添加唯一的标识符，从而使TLS流量带有唯一的指纹，导致黑客能够轻易在网络上追踪来自受感染主机的加密流量。</p>
<h4 id="sofacy">Sofacy</h4>
<p>Zebrocy是我们于2015年底发现的一款归属于Sofacy组织的恶意软件家族，由Delphi下载器、AutoIt下载器和Delphi后门组成，主要针对欧亚地区进行间谍活动。今年Zebrocy再次升级，在6月份对东南亚某一外交事务机构的攻击中使用了一个新Python脚本——PythocyDbg，此脚本主要提供网络代理和通信调试功能的秘密收集。</p>
<p>早在2019年初，Zebrocy就改变了开发方向，使用了Nimrod/Nim语言，这是一种语法类似于Pascal和Python的编程语言，可以把目标程序编译为JavaScript 或 C 语言。该组织用于鱼叉式网络钓鱼的Nim下载程序和其他Nim后门代码目前都由Zebrocy生成，并与AutoIT脚本、Go和Delphi模块一起交付。</p>
<p>今年9月，Zebrocy在欧洲多地发起攻击，试图获取电子邮件通信、凭据和敏感文件，此次行动主要针对的是各国的国防和外交机构。</p>
<h4 id="platinum">Platinum</h4>
<p>6月，我们发现一系列高度复杂的网络间谍攻击行动，其目的是窃取南亚的外交、政府和军事实体的信息。这些攻击行动持续了近六年，对其中使用的工具手段进一步调查后发现，背后的攻击者为PLATIUM组织——一个我们认为已经消失的网络间谍组织。能在如此长的时间里保持行动隐蔽，是因为Platinum使用了一种前所未见的隐写技术。</p>
<p>而今年年末，我们又发现了Platinum的一个新后门——Titanium，该恶意软件与一个称为ProjectC的工具集之间存在某些相似性，说明之前利用ProjectC进行的CloudComputating行动也可以归因于Platinum。</p>
<h4 id="lazarus">Lazarus</h4>
<p>去年，Lazarus组织利用AppleJeus恶意软件对Mac OS用户展开加密货币窃取行动，今年又使用自定义PowerShell脚本来管理和控制Windows/macOS 恶意软件，进一步拓展了加密攻击。</p>
<p>Lazarus更新工具的速度很快，除了加密攻击外，还窃取了韩国某游戏公司的程序源码售卖。到了三季度，又入侵了缅甸一家银行，通过公共登录凭据转储程序和自制的PowerShell脚本进行横向移动来获取高价值主机信息。</p>
<p>Lazarus旗下有两个子组织，分别名为BlueNoroff和Andariel，后者专注于韩国的地缘政治和金融情报的间谍活动。今年，Andariel为易受攻击的weblogic服务器构建新的c2基础设施，攻击者成功后会植入了由韩国安全软件供应商合法签名的恶意软件。由于韩国方面的快速反应，这个签名很快就被撤销了。恶意软件是一种全新的后门，名为Apollozeus，它是由一个具有复杂配置的shellcode启动的。这个后门使用了一个相对较大的shellcode，以使分析变得困难。此外，它还会谨慎地执行最终的有效负载。这个恶意软件的发现让我们找到了几个相关的样本，以及攻击者用来传播它的文档。</p>
<h4 id="darkhotel">DarkHotel</h4>
<p>10月，我们发现了一起面向朝鲜的钓鱼攻击事件，主要针对商人，外交实体和人权组织，攻击者使用了高针对性的Ghost RAT恶意软件，可完全控制受害者电脑。据推测，这场行动已经进行了三年多。</p>
<h4 id="lamberts">Lamberts</h4>
<p>Lamberts是一个或多个威胁组织都在使用的工具集，它包括网络驱动的后门、几代模块化后门、信息收集工具以及用于实施破坏性攻击的擦除器。有关Lamberts的更多信息，请参见我们之前“拆解Lamberts工具包”的报告。</p>
<p>今年，Lamberts军火库中又添加了几类新武器。Silver Lambert似乎是Gray Lambert的继任者，它是一个成熟的后门，能实现一些特定的NOBUS和OPSEC概念，例如通过检查服务器SSL证书哈希来防止C2 sink-holing ，为孤立实例自动卸载（即C2不可用的地方）和低级文件擦除功能。中国航空部门就受到过Silver Lambert的影响。</p>
<p>Violet Lambert是一种模块化后门，应该是在2018年开发部署的，能在各种Windows版本（包括Windows XP，Vista和更高版本的Windows）上运行，我们在中东地区观察到了它的存在痕迹，同时还发现了另外三种后门——前两个称为Cyan Lambert（包括Light和Pro版本），第三个称为Magenta Lambert，后者重用了较早的Lamberts代码，并且与Green、Black和White Lamberts具有多个相似之处。此类恶意软件能进行网络侦听，等待魔术ping，以及能非常隐蔽地执行payload，而我们一直无法对其进行解密。就在我们发现后不久，所有受感染的电脑都离线了。</p>
<h4 id="luckymouse">LuckyMouse</h4>
<p>LuckyMouse组织至少自2018年4月以来便一直针对越南政府和外交实体展开“SpoiledLegacy”攻击行动，此次行动被怀疑是是之前IronTiger行动的继承。攻击者使用Cobalt Strike和Metasploit渗透测试框架，主要以网络服务的漏洞为初始感染媒介，此外也通过钓鱼邮件进行感染。除了渗透测试框架外，攻击者还使用NetBot下载器和内网穿透大杀器——EarthWorm，以及将HTran TCP代理源代码包含到恶意软件中来重定向流量。一些NetBot配置数据包含LAN IP，表明它从本地网络中另一台受感染的主机下载下一阶段文件。</p>
<p>LuckyMouse此次的目标依然是内部数据库服务器。感染的最后阶段，攻击者针对32位和64位系统，分别使用特制的注入系统进程内存的木马。值得强调的是，感染链中的所有工具，都使用了泄漏的HackingTeam代码，动态混淆Win32 API调用。</p>
<p>从2019年初开始，我们在中亚和中东观察到LuckyMouse活动的激增。攻击者似乎将重点放在电信运营商、大学和政府上。感染媒介是鱼叉式网络钓鱼以及可能的水坑攻击。尽管去年有很多文章都讨论了LuckyMouse的TTP，但LuckyMouse并没有对其进行任何更改，仍然依靠自己的工具在受害者的网络中站稳脚跟。在新活动中，他们使用HTTPBrowser作为第一阶段，用Soldier Trojan作为第二阶段。LuckyMouse更改了其基础设施，因为它似乎只依赖于IPv4地址，而不是C2的域名，我们认为这是为了限制相关性。</p>
<h4 id="honeymyte">HoneyMyte</h4>
<p>HoneyMyte APT已经活跃好几年了，在过去的几年中采用了多种技术，对缅甸、蒙古、埃塞俄比亚、越南和孟加拉国的政府，以及位于巴基斯坦、韩国、美国、英国、比利时、尼泊尔、澳大利亚和新加坡的外国大使馆发起攻击。今年将目标对准了缅甸自然资源管理相关的政府组织和一个非洲大陆组织，表明HoneyMyte的主要动机之一是收集地缘政治和经济情报。</p>
<h4 id="icefog">Icefog</h4>
<p>自2011年以来，Icefog一直针对主要位于韩国，日本和亚洲中部的政府机构、军事承包商、航运组织、电信运营商、卫星运营商、工业和高科技公司和大众媒体。在2013年该组织被曝光后，运作速度有所放慢，然而2018年后，Icefog又开始对中亚的政府机构和军事承包商发起了大规模进攻。</p>
<p>在最新一波攻击中，感染始于包含了恶意文件的鱼叉式网络钓鱼电子邮件，利用已知漏洞并最终部署了payload。在2018年到2019年初，最终的payload都是典型的Icefog后门，但自2019年5月以后，攻击者似乎改变了立场，转向使用Poison Ivy后门。Poison Ivy是一类恶意DLL文件，使用了一种称为加载顺序劫持（load order hijacking）的技术，通过合法签名的程序进行加载。这种技术非常普遍，在以前的Icefog活动中也使用过。</p>
<p>在调查过程中，我们还检测到横向运动中使用的工具，我们观察了从GitHub下载的公共TCP扫描器、从系统内存转储凭证的Mimikatz变体、用于窃取敏感信息的自定义键盘记录程序，以及另一个名为Quarian的新版本后门的使用。Quarian后门被用来在受害者的基础设施内创建隧道以避免网络探测。Quarian的功能包括操作远程文件系统、获取受害者信息、窃取保存的密码、下载或上传任意文件、使用端口转发创建隧道、执行任意命令和启动反向shell。</p>
<blockquote>
<p>注：本文翻译自：<a href="https://securelist.com/ksb-2019-review-of-the-year/95394/" target="_blank" rel="noopener">https://securelist.com/ksb-2019-review-of-the-year/95394/</a></p>
</blockquote>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                    
                        <li class="next">
                            <a href="/article/麦迪35秒狂得13分，从此麦迪时刻诞生！/" data-toggle="tooltip" data-placement="top" title="麦迪35秒狂得13分，从此麦迪时刻诞生！">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <br>
                <br>

                <!--打赏-->
                
                    <div class="reward">
                        <div class="reward-button">赏 <span class="reward-code"> 
                            <span class="alipay-code"> <img class="alipay-img" src="/img/alipay.jpeg"><b>支付宝打赏</b></span> 
                            <span class="wechat-code"> <img class="wechat-img" src="/img/wechat.jpeg"><b>微信打赏</b> </span>
                            </span></div>
                        <p class="reward-notice">赞赏一下</p>
                    </div>
                
                <!--打赏-->

                <!--分享-->
                
                    <div class="social-share"  data-wechat-qrcode-helper="" align="center"></div>
                    <!--  css & js -->
                    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
                
                <!--分享-->

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#供应链攻击"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">&#x4F9B;&#x5E94;&#x94FE;&#x653B;&#x51FB;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#apt组织信息反泄露"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">APT&#x7EC4;&#x7EC7;&#x4FE1;&#x606F;&#x53CD;&#x6CC4;&#x9732;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#新组织现身"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">&#x65B0;&#x7EC4;&#x7EC7;&#x73B0;&#x8EAB;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#移动攻击"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">&#x79FB;&#x52A8;&#x653B;&#x51FB;</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#apt组织的发展动向"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">APT&#x7EC4;&#x7EC7;&#x7684;&#x53D1;&#x5C55;&#x52A8;&#x5411;</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#turla"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">Turla</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#sofacy"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">Sofacy</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#platinum"><span class="toc-nav-number">5.3.</span> <span class="toc-nav-text">Platinum</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#lazarus"><span class="toc-nav-number">5.4.</span> <span class="toc-nav-text">Lazarus</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#darkhotel"><span class="toc-nav-number">5.5.</span> <span class="toc-nav-text">DarkHotel</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#lamberts"><span class="toc-nav-number">5.6.</span> <span class="toc-nav-text">Lamberts</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#luckymouse"><span class="toc-nav-number">5.7.</span> <span class="toc-nav-text">LuckyMouse</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#honeymyte"><span class="toc-nav-number">5.8.</span> <span class="toc-nav-text">HoneyMyte</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#icefog"><span class="toc-nav-number">5.9.</span> <span class="toc-nav-text">Icefog</span></a></li></ol></li></ol>
        
        </div>
      </aside>
    



                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">特色标签</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#网络安全" title="网络安全">网络安全</a>
                        
                          <a class="tag" href="/tags/#APT" title="APT">APT</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>友情链接</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://www.ctolib.com/docs//sfile/the-way-to-go_ZH_CN/index.html" target="_blank">golang菜鸟教程</a></li>
                    
                        <li><a href="http://docscn.studygolang.com/" target="_blank">golang官网</a></li>
                    
                        <li><a href="https://www.kancloud.cn/hello123/beego/126087" target="_blank">beego教程</a></li>
                    
                        <li><a href="https://www.ctolib.com/docs//sfile/the-way-to-go_ZH_CN/index.html" target="_blank">golang入门指南</a></li>
                    
                        <li><a href="https://github.com/doczhcn/etcd" target="_blank">etcd中文资源</a></li>
                    
                        <li><a href="https://github.com/etcd-io/etcd/tree/master/clientv3" target="_blank">golang使用etcd</a></li>
                    
                        <li><a href="https://github.com/mongodb/mongo-go-driver" target="_blank">golang使用MongoDB</a></li>
                    
                        <li><a href="https://www.mongodb.org.cn/tutorial/" target="_blank">MongoDB中文教程</a></li>
                    
                        <li><a href="http://www.tracy.store/" target="_blank">golang+beego+MySQL博客</a></li>
                    
                </ul>
                

                
<div id="gitment_title" class="gitment_title"></div>
<div id="container" style="display:none"></div>
<link rel="stylesheet" href="https://billts.site/extra_css/gitment.css">
<script src="https://billts.site/js/gitment.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
  const myTheme = {
    render(state, instance) {
      const container = document.createElement('div');
      container.lang = "en-US";
      container.className = 'gitment-container gitment-root-container';
      container.appendChild(instance.renderHeader(state, instance));
      container.appendChild(instance.renderEditor(state, instance));
      container.appendChild(instance.renderComments(state, instance));
      container.appendChild(instance.renderFooter(state, instance));
      return container;
    }
  }

  function showGitment() {
    $("#gitment_title").attr("style", "display:none");
    $("#container").attr("style", "").addClass("gitment_container");
    var gitment = new Gitment({
      id: decodeURI(window.location.pathname),
      theme: myTheme,
      owner: 'TracyPro',
      repo: 'TracyPro.github.io',
      oauth: {
        client_id: '7efbf680ada61c7be014',
        client_secret: '2849d29795ada92ac567d1cfc8dba892494c4a18'
      }
    });
    gitment.render('container');
  }

  showGitment();
</script>

            </div>
        </div>
    </div>
</article>







<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


<script>
    function createImgEventFullScreen() {
        var imgs = $(".post-container").find("img");
        console.log(imgs);
        for (var i = 0; i < imgs.length; i++) {
            // $(imgs[i]).click(createCover(imgs[i]));
            imgs[i].onclick = function (e) {
                var src = e.srcElement.currentSrc;
                var _this = $(this);
                console.log(_this);
                createCover(src,_this);
            }
        }
        function createCover(src,_this) {
            console.log(_this);
            console.log(src);
            var cover = $("<div id='outerDiv'  style='position:fixed;top:0;left:0;background:rgba(0,0,0,0.7);z-index:5;width:100%;height:100%;display:none;'><div id='innerDiv' style='position:absolute;'><img  id='bigImg' style='border:5px solid #fff;' src=''/></div></div>");
            $("#outerDiv").remove();
            $("body").append(cover);
            imgShow("#outerDiv", "#innerDiv", "#bigImg", _this,src);

        }
    }
    function imgShow(outerDiv, innerDiv, bigImg, _this,src) {
        //var src = _this.attr("src"); //获取当前点击的common-img元素中的src属性
        $(bigImg).attr("src", src); //设置#bigImg元素的src属性

        /*获取当前点击图片的真实大小，并显示弹出层及大图*/
        $("<img/>").attr("src", src).load(function () {
            var windowW = $(window).width(); //获取当前窗口宽度
            var windowH = $(window).height(); //获取当前窗口高度
            var realWidth = this.width; //获取图片真实宽度
            var realHeight = this.height; //获取图片真实高度
            var imgWidth, imgHeight;
            var scale = 0.8; //缩放尺寸，当图片真实宽度和高度大于窗口宽度和高度时进行缩放

            if (realHeight > windowH * scale) { //判断图片高度
                imgHeight = windowH * scale; //如大于窗口高度，图片高度进行缩放
                imgWidth = imgHeight / realHeight * realWidth; //等比例缩放宽度
                if (imgWidth > windowW * scale) { //如宽度仍大于窗口宽度
                    imgWidth = windowW * scale; //再对宽度进行缩放
                }
            } else if (realWidth > windowW * scale) { //如图片高度合适，判断图片宽度
                imgWidth = windowW * scale; //如大于窗口宽度，图片宽度进行缩放
                imgHeight = imgWidth / realWidth * realHeight; //等比例缩放高度
            } else { //如果图片真实高度和宽度都符合要求，高宽不变
                imgWidth = realWidth;
                imgHeight = realHeight;
            }
            $(bigImg).css("width", imgWidth); //以最终的宽度对图片缩放

            var w = (windowW - imgWidth) / 2; //计算图片与窗口左边距
            var h = (windowH - imgHeight) / 2; //计算图片与窗口上边距
            $(innerDiv).css({ "top": h, "left": w }); //设置#innerDiv的top和left属性
            //console.log('****')
            $(outerDiv).fadeIn("fast"); //淡入显示#outerDiv
        });

        $(outerDiv).click(function () { //再次点击淡出消失弹出层
            $(this).fadeOut("fast");
        });
    }
    setTimeout(function () {
        createImgEventFullScreen();
    }, 1000)
</script>

<style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>

  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('代码复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)

        if(result)$(this).text('复制成功')
        else $(this).text('复制失败')

        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('代码复制')
        }, 300)
      }).append(e)
    })
  </script>


    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/u/6161631844?refer_flag=1005055010_&amp;is_all=1">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="/img/wechat_tracy.jpeg">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-wechat fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="/img/qq_tracy.jpeg">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-qq fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                


                

                
                    <li>
                        <a target="_blank"  href="https://github.com/TracyPro">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-center">
                
                    <!-- 不蒜子统计 -->
                    <span id="busuanzi_container_site_uv" style='display:none'>
                        本站访客数<span id="busuanzi_value_site_uv"></span>人
                    </span>
                
                    Copyright &copy; 张嘉伟 2019 
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="https://tracypro.github.io">张嘉伟</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=tracypro&repo=tracypro.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://tracy.pro/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'xxx';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>






    <a id="rocket" href="#top" class=""></a>
    <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>

</body>

</html>
